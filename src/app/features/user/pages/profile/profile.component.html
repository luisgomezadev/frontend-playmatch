<app-layout [title]="'Perfil'" [subtitle]="'Gestiona tu información personal'">
  <div class="flex flex-col gap-6">
    <article
      class="bg-white border border-slate-200 rounded-xl p-6 shadow-sm flex items-center justify-between">
      <div class="flex items-center justify-start gap-6 h-full">
        <button
          class="group cursor-pointer relative overflow-hidden rounded-full ring-2 ring-primary/30"
          (click)="openModal()">
          <img
            [src]="getImageUrl(user)"
            alt="Foto de {{ user.fullName }}"
            class="size-20 md:size-28 object-cover" />
          <div
            class="w-full h-full rounded-full bg-black/30 absolute inset-0 flex items-center justify-center flex-col gap-1 text-white text-center opacity-0 group-hover:opacity-100 transition-opacity duration-300">
            <i class="fa-solid fa-camera text-white text-3xl"></i>
            <span class="text-base leading-none">Cambiar imagen</span>
          </div>
        </button>

        <div class="space-y-1 text-center">
          <h2 class="text-xl md:text-2xl font-semibold text-slate-800">
            {{ user.fullName }}
          </h2>
        </div>
      </div>
      <div class="hidden sm:block">
        <button
          class="group flex items-center justify-center gap-3 p-4 text-red-600 hover:text-red-700 hover:bg-red-50 border border-red-200 rounded-xl transition-all duration-300 hover:shadow-md"
          (click)="logout()">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="lucide lucide-log-out w-4 h-4 group-hover:scale-110 transition-transform">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
            <polyline points="16 17 21 12 16 7"></polyline>
            <line x1="21" x2="9" y1="12" y2="12"></line>
          </svg>
          <span class="font-medium">Cerrar sesión</span>
        </button>
      </div>
    </article>

    <article class="bg-white border border-slate-200 rounded-xl p-6 shadow-sm space-y-8">
      <div class="space-y-4">
        <h3 class="font-bold text-slate-900 flex items-center gap-3 text-lg">
          <div class="p-2 bg-slate-100 rounded-lg">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="lucide lucide-settings w-5 h-5 text-slate-700">
              <path
                d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"></path>
              <circle cx="12" cy="12" r="3"></circle>
            </svg>
          </div>
          Información de contacto
        </h3>
        <div class="grid sm:grid-cols-2 gap-4">
          <div
            class="group flex items-center gap-4 p-4 bg-gradient-to-r from-slate-50 to-slate-100/50 border border-slate-200 rounded-xl hover:shadow-md hover:border-slate-300 transition-all duration-200">
            <div class="p-2 bg-slate-200 rounded-lg group-hover:bg-slate-300 transition-colors">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="lucide lucide-phone w-5 h-5 text-slate-700">
                <path
                  d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path>
              </svg>
            </div>
            <div class="min-w-0 flex-1">
              <p class="text-sm font-semibold text-slate-600 mb-1">Teléfono</p>
              <p class="text-slate-900 font-medium truncate">{{ user.cellphone }}</p>
            </div>
          </div>
          <div
            class="group flex items-start gap-4 p-4 bg-gradient-to-r from-slate-50 to-slate-100/50 border border-slate-200 rounded-xl hover:shadow-md hover:border-slate-300 transition-all duration-200">
            <div
              class="p-2 bg-slate-200 rounded-lg group-hover:bg-slate-300 transition-colors mt-0.5">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="w-5 h-5 text-slate-700">
                <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                <path
                  d="M3 7a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-10z" />
                <path d="M3 7l9 6l9 -6" />
              </svg>
            </div>
            <div class="min-w-0 flex-1">
              <p class="text-sm font-semibold text-slate-600 mb-1">Correo electrónico</p>
              <p class="text-slate-900 font-medium break-words leading-relaxed">{{ user.email }}</p>
            </div>
          </div>
        </div>
      </div>
      <div class="space-y-4">
        <h3 class="font-bold text-slate-900 flex items-center gap-3 text-lg">
          <div class="p-2 bg-slate-100 rounded-lg">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
              class="w-5 h-5 text-slate-700">
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path d="M3 21l18 0" />
              <path d="M9 8l1 0" />
              <path d="M9 12l1 0" />
              <path d="M9 16l1 0" />
              <path d="M14 8l1 0" />
              <path d="M14 12l1 0" />
              <path d="M14 16l1 0" />
              <path d="M5 21v-16a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v16" />
            </svg>
          </div>
          Información de tu complejo deportivo
        </h3>
        @if (loadingVenue) {
          <div class="grid sm:grid-cols-2 gap-4">
            <!-- Repite 4 veces (puedes usar *ngFor si quieres dinamismo) -->
            <div
              class="flex items-center gap-4 p-4 bg-slate-100 border border-slate-200 rounded-xl animate-pulse">
              <!-- Icono skeleton -->
              <div class="p-2 bg-slate-200 rounded-lg w-10 h-10"></div>
              <div class="flex-1 space-y-2">
                <div class="h-3 bg-slate-200 rounded w-1/3"></div>
                <div class="h-4 bg-slate-300 rounded w-2/3"></div>
              </div>
            </div>

            <div
              class="flex items-center gap-4 p-4 bg-slate-100 border border-slate-200 rounded-xl animate-pulse">
              <div class="p-2 bg-slate-200 rounded-lg w-10 h-10"></div>
              <div class="flex-1 space-y-2">
                <div class="h-3 bg-slate-200 rounded w-1/3"></div>
                <div class="h-4 bg-slate-300 rounded w-2/3"></div>
              </div>
            </div>

            <div
              class="flex items-center gap-4 p-4 bg-slate-100 border border-slate-200 rounded-xl animate-pulse">
              <div class="p-2 bg-slate-200 rounded-lg w-10 h-10"></div>
              <div class="flex-1 space-y-2">
                <div class="h-3 bg-slate-200 rounded w-1/3"></div>
                <div class="h-4 bg-slate-300 rounded w-2/3"></div>
              </div>
            </div>

            <div
              class="flex items-center gap-4 p-4 bg-slate-100 border border-slate-200 rounded-xl animate-pulse">
              <div class="p-2 bg-slate-200 rounded-lg w-10 h-10"></div>
              <div class="flex-1 space-y-2">
                <div class="h-3 bg-slate-200 rounded w-1/3"></div>
                <div class="h-4 bg-slate-300 rounded w-2/3"></div>
              </div>
            </div>
          </div>
        } @else {
          @if (venue) {
            <div class="grid sm:grid-cols-2 gap-4">
              <div
                class="group flex items-center gap-4 p-4 bg-gradient-to-r from-slate-50 to-slate-100/50 border border-slate-200 rounded-xl hover:shadow-md hover:border-slate-300 transition-all duration-200">
                <div class="p-2 bg-slate-200 rounded-lg group-hover:bg-slate-300 transition-colors">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="w-5 h-5 text-slate-700">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path
                      d="M5 4h4l3 3h7a2 2 0 0 1 2 2v8a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2v-11a2 2 0 0 1 2 -2" />
                  </svg>
                </div>
                <div class="min-w-0 flex-1">
                  <p class="text-sm font-semibold text-slate-600 mb-1">Nombre</p>
                  <p class="text-slate-900 font-medium truncate">{{ venue.name }}</p>
                </div>
              </div>
              <div
                class="group flex items-start gap-4 p-4 bg-gradient-to-r from-slate-50 to-slate-100/50 border border-slate-200 rounded-xl hover:shadow-md hover:border-slate-300 transition-all duration-200">
                <div
                  class="p-2 bg-slate-200 rounded-lg group-hover:bg-slate-300 transition-colors mt-0.5">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="lucide lucide-map-pin w-5 h-5 text-slate-700">
                    <path
                      d="M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0"></path>
                    <circle cx="12" cy="10" r="3"></circle>
                  </svg>
                </div>
                <div class="min-w-0 flex-1">
                  <p class="text-sm font-semibold text-slate-600 mb-1">Ciudad</p>
                  <p class="text-slate-900 font-medium break-words leading-relaxed">
                    {{ venue.city }}
                  </p>
                </div>
              </div>
              <div
                class="group flex items-start gap-4 p-4 bg-gradient-to-r from-slate-50 to-slate-100/50 border border-slate-200 rounded-xl hover:shadow-md hover:border-slate-300 transition-all duration-200">
                <div
                  class="p-2 bg-slate-200 rounded-lg group-hover:bg-slate-300 transition-colors mt-0.5">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="w-5 h-5 text-slate-700">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" />
                    <path d="M12 12l3 2" />
                    <path d="M12 7v5" />
                  </svg>
                </div>
                <div class="min-w-0 flex-1">
                  <p class="text-sm font-semibold text-slate-600 mb-1">Horario</p>
                  <p class="text-slate-900 font-medium break-words leading-relaxed">
                    {{ venue.openingHour | timeFormat }} a {{ venue.closingHour | timeFormat }}
                  </p>
                </div>
              </div>
              <div
                class="group flex items-start gap-4 p-4 bg-gradient-to-r from-slate-50 to-slate-100/50 border border-slate-200 rounded-xl hover:shadow-md hover:border-slate-300 transition-all duration-200">
                <div
                  class="p-2 bg-slate-200 rounded-lg group-hover:bg-slate-300 transition-colors mt-0.5">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="w-5 h-5 text-slate-700">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path d="M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0" />
                    <path d="M3 9h3v6h-3z" />
                    <path d="M18 9h3v6h-3z" />
                    <path
                      d="M3 5m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z" />
                    <path d="M12 5l0 14" />
                  </svg>
                </div>
                <div class="min-w-0 flex-1">
                  <p class="text-sm font-semibold text-slate-600 mb-1">No. de canchas</p>
                  <p class="text-slate-900 font-medium break-words leading-relaxed">
                    {{ venue.fields.length }} disponibles
                  </p>
                </div>
              </div>
            </div>
          } @else {
            <app-create-venue-card />
          }
        }
      </div>
    </article>
  </div>
  <div class="mt-8 pt-6 border-t border-slate-200 sm:hidden">
    <button
      class="group flex items-center justify-center gap-3 w-full p-4 text-red-600 hover:text-red-700 hover:bg-red-50 border border-red-200 rounded-xl transition-all duration-200 hover:shadow-md"
      (click)="logout()">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        class="lucide lucide-log-out w-4 h-4 group-hover:scale-110 transition-transform">
        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
        <polyline points="16 17 21 12 16 7"></polyline>
        <line x1="21" x2="9" y1="12" y2="12"></line>
      </svg>
      <span class="font-medium">Cerrar sesión</span>
    </button>
  </div>
</app-layout>

<app-modal [open]="isOpen()" (closed)="onClosed()" [title]="'Actualizar foto de perfil'">
  <input
    id="profile-file-input"
    #fileInput
    type="file"
    accept="image/*"
    (change)="onFileSelected($event)"
    class="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-medium tracking-wide file:bg-green-100 file:text-primary-700 hover:file:bg-green-200 file:cursor-pointer file:transition-colors" />

  @if (imagePreview) {
    <div class="mt-4 text-center">
      <p class="text-sm text-gray-500 mb-2">Previsualización:</p>
      <img
        [src]="imagePreview"
        alt="Preview"
        class="w-32 h-32 object-cover rounded-full mx-auto border border-gray-300" />
    </div>
  }

  <div class="flex justify-center mt-6 space-x-2">
    <app-button (clicked)="onClosed()" text="Cancelar" color="black"></app-button>
    <app-button
      (clicked)="onUploadImage()"
      color="primary"
      text="Actualizar imagen"
      [loading]="loading"
      [disabled]="!selectedFile"></app-button>
  </div>
</app-modal>
